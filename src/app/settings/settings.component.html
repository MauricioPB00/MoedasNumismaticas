<div class="settings-container">
  <div class="settings-header-title">
    <h2>Alterar meus dados</h2>
  </div>
  <div class="settings-header-profile">
    <div class="settings-header" (click)="toggleForm()">
      <span class="arrow">{{ showForm ? 'Editar Perfil ▲' : 'Editar Perfil ▼' }}</span>
    </div>

    <form [class.expanded]="showForm" (ngSubmit)="onSubmit()" #profileForm="ngForm">
      <label for="name">Nome</label>
      <input type="text" id="name" name="name" [(ngModel)]="user.name" required />

      <label for="email">E-mail</label>
      <input type="email" id="email" name="email" [(ngModel)]="user.email" required />

      <label for="cpf">CPF</label>
      <input type="text" id="cpf" name="cpf" [(ngModel)]="user.cpf" />

      <label for="rg">RG</label>
      <input type="text" id="rg" name="rg" [(ngModel)]="user.rg" />

      <label for="datNasc">Data de Nascimento</label>
      <input type="date" id="datNasc" name="datNasc" [(ngModel)]="user.datNasc" />

      <label for="city">Cidade</label>
      <input type="text" id="city" name="city" [(ngModel)]="user.city" />

      <label for="number">Telefone</label>
      <input type="text" id="number" name="number" [(ngModel)]="user.number" />

      <button type="submit">Salvar alterações</button>
    </form>
  </div>

  <div class="settings-header-photo">
    <div class="settings-header-profile">
      <div class="settings-header" (click)="togglePhoto()">
        <span class="arrow">{{ showPhoto ? 'Editar Foto ▲' : 'Editar Foto ▼' }}</span>
      </div>
      <form [class.expanded]="showPhoto" (ngSubmit)="onSubmitPhoto()" enctype="multipart/form-data">
        <div class="photo-preview">
          <a (click)="selectFileInput.click()">
            <img [src]="previewUrl ? previewUrl : user?.photo ? environment.API_URL + '/uploads/users/' + user.photo
                : 'assets/img/person.png'" class="profile-photo" />
          </a>
        </div>
        <div class="photo-btn-container">
          <button type="button" class="change-photo-btn" (click)="selectFileInput.click()">
            Alterar Foto
          </button>
          <input type="file" hidden #selectFileInput (change)="onFileSelected($event)" accept="image/*">
        </div>
        <button type="submit">Salvar Foto</button>
      </form>
    </div>
  </div>

  <div class="settings-header-banner">
    <div class="settings-header-profile">

      <div class="settings-header" (click)="toggleBanner()">
        <span class="arrow">
          {{ showBanner ? 'Banner Anúncio ▲' : 'Banner Anúncio ▼' }}
        </span>
      </div>

      <form [class.expanded]="showBanner" enctype="multipart/form-data">
        <div class="banner-upload-container">

          <h3 *ngIf="!existingBanner">Enviar banner de anúncio</h3>
          <h3 *ngIf="existingBanner">Editar banner de anúncio</h3>

          <p class="description">Imagem recomendada: 1200×300, JPG ou PNG, até 3 MB.</p>

          <p class="banner-review-msg" *ngIf="bannerInReview">
            Seu banner foi enviado para análise!
          </p>

          <div class="url-input-box">
            <label for="advUrl">Link do anúncio</label>
            <input id="advUrl" type="text" placeholder="https://seusite.com" [(ngModel)]="advertisingUrl"
              name="advertisingUrl" />
          </div>

          <label class="upload-box" (drop)="onDrop($event)" (dragover)="onDragOver($event)">
            <input type="file" accept="image/png, image/jpeg" hidden (change)="onFileSelectBanner($event)" />

            <ng-container *ngIf="!preview">
              <span class="upload-text">Clique ou arraste sua imagem aqui</span>
            </ng-container>

            <img *ngIf="preview" [src]="preview" class="preview-img" />
          </label>

          <p class="error" *ngIf="errorMessage">{{ errorMessage }}</p>

          <button class="btn-submit" [disabled]="!validImage" (click)="submitBanner()">
            Salvar Banner
          </button>

          <button *ngIf="existingBanner" class="btn-delete" (click)="deleteBanner()">
            Remover Banner
          </button>

          <a href="assets/img/template/Template_Banner_1200x300.png" download="Template_Banner_1200x300.png"
            class="btn-template">
            Baixar Template
          </a>
        </div>
      </form>

    </div>
  </div>

  <div class="settings-header-logout">
    <div class="settings-header-profile">
      <div class="settings-header" (click)="toggleLogout()">
        <span class="arrow">{{ showLogout ? 'Deslogar ▲' : 'Deslogar ▼' }}</span>
      </div>
      <form [class.expanded]="showLogout" (ngSubmit)="onSubmitLogout()" enctype="multipart/form-data">
        <button type="submit">Sair da Conta</button>
      </form>
    </div>
  </div>
</div>